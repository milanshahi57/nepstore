{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" type="text/css" href="{% static 'css/product_detail.css' %}">

<div class="product-detail">
    <h2 class="product-title">{{ product.name }}</h2>
    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-image">
    
    <p class="product-price">Price: Rs. <span id="product-price">{{ product.price }}</span></p>

    <!-- Quantity Selector -->
    <div class="product-quantity">
        <label for="quantity">Quantity:</label>
        <button type="button" class="qty-btn" onclick="decreaseQuantity()">-</button>
        <input type="number" id="quantity" name="quantity" value="1" min="1">
        <button type="button" class="qty-btn" onclick="increaseQuantity()">+</button>
    </div>

    <!-- Total Price -->
    <p>Total: Rs. <span id="total-price">{{ product.price }}</span></p>

    <!-- Add to Cart Form -->
    <form method="POST" action="{% url 'add_to_cart' product.id %}">
        {% csrf_token %}
        <input type="hidden" name="quantity" id="hidden-quantity" value="1">
        <button type="submit" class="add-to-cart-btn">Add to Cart</button>
    </form>
</div>

<script>
    const productPrice = {{ product.price }};
    const quantityInput = document.getElementById('quantity');
    const totalPriceElement = document.getElementById('total-price');
    const hiddenQuantity = document.getElementById('hidden-quantity');

    function updateTotalPrice() {
        let quantity = parseInt(quantityInput.value);
        totalPriceElement.innerText = (quantity * productPrice).toFixed(2);
        hiddenQuantity.value = quantity;
    }

    function increaseQuantity() {
        quantityInput.value = parseInt(quantityInput.value) + 1;
        updateTotalPrice();
    }

    function decreaseQuantity() {
        if (quantityInput.value > 1) {
            quantityInput.value = parseInt(quantityInput.value) - 1;
            updateTotalPrice();
        }
    }

    quantityInput.addEventListener('input', updateTotalPrice);
</script>

{% endblock %}
